# Manifest 路径格式变换体操

基本规则: Manifest 内部使用相对路径, 对外则提供绝对路径.

为什么?

**内部使用相对路径**

考虑到 start_directory 是允许在运行时变更的, 每次 start_directory 变更, 都意味着所有记录在清单中的资源的路径也相应地发生改变. 如果内部使用了绝对路径, 我们必须照顾好每一次 start_directory 变化对所有资源路径的重新调整.

更严重的是, 在两个不同来源的 Manifest 对象进行比较时, 绝对路径就是来捣乱的. 我们还不得不再转回相对路径.

此外, 目前的代码中的变动因素只需要考虑 start_directory, 但未来不排除增加其他影响资源路径的因素. 我不希望多种因素作用下, 需要理清每一次变化都要在恰当的时机重新计算出准确的绝对路径, 而这些大多数是无用功.

**对外提供绝对路径**

对外就来到了应用层. 我们在应用层所做的事就是处理资产. 而资产的依据就是它的路径, 准确地说, 绝对路径.

比如读取/写入/复制/解压/移动文件, 我们需要它的绝对路径.

## 内外路径格式转换

转换是由 Manifest 完成的. 基本思路是, 外部想要获取一个键, 走 `Manifest.__getitem__` 方法, Manifest 察觉到对方要的是一个路径, 就返回 `self._start_directory + '/' + the_relpath` 给对方.

以上为示意理解, 具体代码请见 `/depsland/manifest/manifest.py : [class] Manifest`.

